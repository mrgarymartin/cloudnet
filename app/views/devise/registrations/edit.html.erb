<% breadcrumb :edit_user %>
<% title "Edit User" %>

<%= devise_error_messages! %>

<div class="jg-widget-content">
  <div class="jg-widget-header pure-g clearfix">
    <h2 class="pure-u jg-icon icon-user">Edit <%= resource_name.to_s.humanize %></h2>
  </div>
  <div class="jg-widget-body">
    <%= form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => { :method => :put, :class => "form-devise", :role => "form" }) do |f| %>
      <div class="jg-widget-form pure-g-r clearfix">

        <% if devise_mapping.confirmable? && (resource.pending_reconfirmation? || !resource.confirmed?) %>
          <div class='alert alert-info'>
            Currently waiting confirmation for: <%= resource.unconfirmed_email || resource.email %>.
            <%= link_to('Click here', user_confirmation_path(user: {email: resource.unconfirmed_email || resource.email}), method: :post) %> to resend confirmation email.
          </div>
        <% end %>

        <div class="pure-g">
          <div class="form-group pure-u-1-2">
            <%= f.label :full_name, {class: 'pure-u-1'} %>
            <%= f.text_field :full_name, :autofocus => true, :class => "form-control", :placeholder => "Full Name" %>
          </div>

          <div class="form-group pure-u-1-2">
            <%= f.label :email, {class: 'pure-u-1'} %>
            <%= f.email_field :email, :class => "form-control", :placeholder => "Email" %>
          </div>

        </div>

        <div class="pure-g">
          <div class="form-group pure-u-1-2">
            <%= f.label :password, 'New Password (if you wish to change password)', {class: 'pure-u'} %>
            <%= f.password_field :password, :class => "form-control", :placeholder => "Password" %>
          </div>

          <div class="form-group pure-u-1-2">
            <%= f.label :password_confirmation, 'New Password Confirmation (if you wish to change password)', {class: 'pure-u'} %>
            <%= f.password_field :password_confirmation, :class => "form-control", :placeholder => "Password (confirm)" %>
          </div>
        </div>

        <div class="form-group pure-u-1">
          <%= f.label :current_password, {class: 'pure-u'} %>
          <%= f.password_field :current_password, :class => "form-control", :placeholder => "Current password", autocomplete: :off %>
        </div>

      </div>
      <div class="jg-widget-footer actions clearfix">
        <ul class="jg-widget-controls">
          <li><%= f.button "Save changes", :class => "btn jg-submit-button" %></li>
          <li><%= link_to "Back", :back, :class => 'btn jg-back-button' %></li>
          <% if 1 == 2 %>
          <li>
            <%= link_to "Cancel my account", registration_path(resource_name), :data => { :confirm => "Are you sure?" }, :method => :delete, :class => "btn jg-back-button" %>
          </li>
          <% end %>
        </ul>
      </div>
    <% end %>
  </div>
</div>

<div class="jg-widget-content">
  <div class="jg-widget-header pure-g clearfix">
    <h2 class="pure-u jg-icon icon-user">Two Factor Authentication</h2>
  </div>
  <div class="jg-widget-body jg-otp-explain">
    <div class="jg-widget-form pure-g-r clearfix">
      <p><%= I18n.t('explain', {:scope => 'devise.otp.tokens'}) %></p>
    </div>
  </div>

  <div class="jg-widget-footer actions clearfix">
    <ul class="jg-widget-controls">
      <li><%= link_to "Manage Two Factor Authentication", user_otp_token_path, :class => "btn jg-submit-button" %></li>
    </ul>
  </div>
</div>

<%= render partial: 'keys/ssh_keys' if ENV['DOCKER_PROVISIONER'].present? %>
<%= render partial: 'api_keys/index' %>
